Code is based on this two Arduino forum's threads:
http://www.arduino.cc/cgi-bin/yabb2/YaBB.pl?num=1265696343
http://www.arduino.cc/cgi-bin/yabb2/YaBB.pl?num=1245352653